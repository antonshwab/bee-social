<!doctype html>
<html>
   <head>
       <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
   </head>
    <body style="margin:0">
        <svg data-toggle="tooltip" data-placement="right" title="Tooltip on right"></svg>
    </body>

   <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
   <script>
       var N = 5;
       var svg = d3.select("svg")
        .attr('width',window.innerWidth)
        .attr('height',window.innerHeight);
       
       
       function redrawLines(data){
           var line = svg.selectAll("line")
            .data(data, function(d){ return d; });
           
           line.enter().append("line")
            .attr("x1", function(d){ return getCoord(d.from)[0];})
            .attr("y1", function(d){ return getCoord(d.from)[1];})
            .attr("x2", function(d){ return getCoord(d.to)[0];})
            .attr("y2", function(d){ return getCoord(d.to)[1];})
            .attr("stroke","#000000");
           line.exit().remove();
       }
       
       function redrawCircs(data){
            var circle = svg.selectAll("circle")
             .data(data, function(d) { return d; });
           
           circle.enter().append("circle")
                .attr("cy", function(d){return d.y;})
                .attr("cx", function(d){return d.x;})
                .attr("r", 10)
                .attr("id",function(d){return d.ID;})
                .attr("fill", function(d){return getAccountColor(d.type);});
           
           circle.exit().remove();
           
           
        }
       
       //SVG------------------------------------------
       
       //DATA-----------------------------------------
       var circs = [];
       var lines = [];
       var N=1;
       window.addEventListener('click',function(){
           
           circs = [];
           lines = [];
           
           for(i = 0;i<N;i++){
               
               var circ = new Object();
               let jsonMetadata = '{"name":"imaguru","type":"sponsor","description":"IMAGURU - это первый в Беларуси бизнес клуб, основной задачей которого является продвижение молодого бизнеса (стартапа) в нашей стране. Это новый для Беларуси формат, который оправдал себя в США, Европе, и России. Философия IMAGURU – это стремление изменить мир к лучшему. Деятельность клуба сфокусирована вокруг двух основных направлений: инновации и предпринимательство. В IMAGURU ценится желание делиться знаниями, создавать что-то новое и сделать невозможное возможным","img":"https://bel.biz/assets/new_images/images/bizumstvo/logo-imaguru.png"}';
               let info = JSON.parse(jsonMetadata);
               
               circ.x = window.innerWidth/2 + 200*Math.cos(i*2*Math.PI/N);
               circ.y = window.innerHeight/2 + 200*Math.sin(i*2*Math.PI/N);
               circ.ID = i;
               circ.name = info.name;
               circ.type = info.type;
               circ.description = info.description;
               circ.img = info.img;
               circs.push(circ);
               
               var line = new Object();
               let jsonMetadata1 = '{"from":"imaguru","to":"fund dobra","description":"Project: hackathon Social Weekend","tokens":"1000","moreinfo":"24-25 February, Hackathon Social Weekend "}';
               if(i==0){
                   line.from = 0;
               }else{
                   line.from = i-1;
               }
               line.to = i;
               lines.push(line);
               //console.log(getCoord(line.from)+' '+getCoord(line.to));
           }
           
                     
           redrawLines(lines);
           redrawCircs(circs);
           //console.log(getCircById(i));
           N++;
       });
       
       
       
       function getCoord(id){
           let thisCirc = getCircById(id);
           return [thisCirc.x,thisCirc.y];
       }
       
       function getCircById(id){
           for(i=0;i<circs.length;i++){
               if(circs[i].ID == id){
                   return circs[i];
               }
           }
       }
       function getAccountColor(type){
           if(type=="npo"){
               return "#4ad331";
           }else if(type=="sponsor"){
               return "#eb2828";
           }else if(type=="volunteer"){
               return "#ebf247";
           }
       }
       function getTransactionColor(type){
           if(type=="resource"){
               return "#9036dd";
           }else if(type=="project"){
               return "#2e9cbe";
           }
       }
       
    </script>
</html>